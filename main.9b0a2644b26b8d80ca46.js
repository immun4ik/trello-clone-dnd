(()=>{"use strict";function t(t,n){return function(t){if(Array.isArray(t))return t}(t)||function(t,e){var n=null==t?null:"undefined"!=typeof Symbol&&t[Symbol.iterator]||t["@@iterator"];if(null!=n){var r,a,d,c,o=[],l=!0,i=!1;try{if(d=(n=n.call(t)).next,0===e){if(Object(n)!==n)return;l=!1}else for(;!(l=(r=d.call(n)).done)&&(o.push(r.value),o.length!==e);l=!0);}catch(t){i=!0,a=t}finally{try{if(!l&&null!=n.return&&(c=n.return(),Object(c)!==c))return}finally{if(i)throw a}}return o}}(t,n)||function(t,n){if(t){if("string"==typeof t)return e(t,n);var r={}.toString.call(t).slice(8,-1);return"Object"===r&&t.constructor&&(r=t.constructor.name),"Map"===r||"Set"===r?Array.from(t):"Arguments"===r||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r)?e(t,n):void 0}}(t,n)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function e(t,e){(null==e||e>t.length)&&(e=t.length);for(var n=0,r=Array(e);n<e;n++)r[n]=t[n];return r}var n={columns:[{id:"column-1",title:"TODO",cards:[]},{id:"column-2",title:"In Progress",cards:[]},{id:"column-3",title:"Done",cards:[]}]},r=function(){try{var t=localStorage.getItem("trello-board-state");return null===t?n:JSON.parse(t)}catch(t){return console.error("Error loading state from LocalStorage:",t),n}}();function a(){try{var t=JSON.stringify(r);localStorage.setItem("trello-board-state",t)}catch(t){console.error("Error saving state to LocalStorage:",t)}}var d=document.getElementById("trello-board");function c(t){var e=document.createElement("div");e.classList.add("column"),e.dataset.columnId=t.id;var n=document.createElement("div");n.classList.add("column-header"),n.textContent=t.title,e.append(n);var a=document.createElement("div");a.classList.add("cards-list"),a.dataset.columnId=t.id,e.append(a),t.cards.forEach(function(e){a.append(function(t,e){var n=document.createElement("div");n.classList.add("card"),n.dataset.cardId=t.id,n.dataset.columnId=e,n.setAttribute("draggable","true"),n.textContent=t.content;var a=document.createElement("button");return a.classList.add("card-delete-btn"),a.innerHTML="&times;",a.addEventListener("click",function(n){n.stopPropagation(),function(t,e){var n=r.columns.find(function(t){return t.id===e});n&&(n.cards=n.cards.filter(function(e){return e.id!==t})),l()}(t.id,e)}),n.append(a),n}(e,t.id))});var d=document.createElement("button");return d.classList.add("add-card-btn"),d.textContent="Add another card",d.addEventListener("click",function(){return function(t,e){var n=e.closest(".column");e.style.display="none";var a=document.createElement("div");a.classList.add("add-card-form");var d=document.createElement("textarea");d.classList.add("add-card-textarea"),d.placeholder="Enter a title for this card...",d.rows=3,a.append(d);var c=document.createElement("div");c.classList.add("add-card-controls");var i=document.createElement("button");i.classList.add("submit-card-btn"),i.textContent="Add Card",i.addEventListener("click",function(){var n=d.value.trim();n&&function(t,e){var n={id:"xxxxxxxx-xxxx-4xxx-yxxx-xxxxxxxxxxxx".replace(/[xy]/g,function(t){var e=16*Math.random()|0;return("x"==t?e:3&e|8).toString(16)}),content:t},a=r.columns.find(function(t){return t.id===e});a&&a.cards.push(n),l()}(n,t),o(0,a,e)}),c.append(i);var s=document.createElement("button");s.classList.add("cancel-card-btn"),s.innerHTML="&times;",s.addEventListener("click",function(){return o(0,a,e)}),c.append(s),a.append(c),n.append(a),d.focus()}(t.id,d)}),e.append(d),e}function o(t,e,n){e.remove(),n.style.display="block"}function l(){d.innerHTML="",r.columns.forEach(function(t){d.append(c(t))}),a()}var i=null,s=null,u=null,f=-1,m=0,v=0,p=!1;d.addEventListener("dragstart",function(t){var e=t.target.closest(".card");if(e&&e.classList.contains("card")){u=(i=e).dataset.columnId;var n=r.columns.find(function(t){return t.id===u});f=n.cards.findIndex(function(t){return t.id===i.dataset.cardId}),m=t.clientX,v=t.clientY,t.dataTransfer.setData("text/plain",JSON.stringify({cardId:i.dataset.cardId,originalColumnId:u,originalCardIndex:f})),t.dataTransfer.effectAllowed="move",document.body.classList.add("grabbing")}else t.preventDefault()}),d.addEventListener("dragend",function(){s&&s.parentNode&&s.remove(),i&&i.classList.remove("dragging"),document.body.classList.remove("grabbing"),i=null,s=null,u=null,f=-1,p=!1}),d.addEventListener("dragover",function(t){if(t.preventDefault(),t.dataTransfer.dropEffect="move",i){if(!p){var e=Math.abs(t.clientX-m),n=Math.abs(t.clientY-v);if(Math.sqrt(e*e+n*n)<5)return;p=!0,i.classList.add("dragging"),(s=document.createElement("div")).classList.add("card-placeholder"),s.style.setProperty("--placeholder-height","".concat(i.offsetHeight,"px"))}var r=t.target.closest(".card, .column, .cards-list"),a=null,d=null;if(r&&(r.classList.contains("card")?a=(d=r.parentNode).closest(".column"):r.classList.contains("cards-list")?(d=r,a=r.closest(".column")):r.classList.contains("column")&&(a=r,d=r.querySelector(".cards-list"))),a&&d&&s){var c=null,o=Array.from(d.children).filter(function(t){return t.classList.contains("card")&&t!==i&&t!==s});if(0===o.length)c=null;else{for(var l=0;l<o.length;l++){var u=o[l],f=u.getBoundingClientRect(),g=f.top+f.height/2;if(t.clientY<=g){c=u;break}}null===c&&(c=null)}(!s.parentNode||s.parentNode!==d||null===c&&d.lastElementChild!==s||null!==c&&s.nextSibling!==c)&&(s.parentNode&&s.remove(),c?d.insertBefore(s,c):d.appendChild(s))}}}),d.addEventListener("drop",function(e){if(e.preventDefault(),i&&s){var n;try{n=JSON.parse(e.dataTransfer.getData("text/plain"))}catch(t){return void console.error("Error parsing drag data:",t)}n.cardId;var d=n.originalColumnId,c=n.originalCardIndex,o=s.parentNode;if(o){for(var l=o.closest(".column").dataset.columnId,m=0,v=0,g=Array.from(o.children);v<g.length;v++){var x=g[v];if(x===s)break;x.classList.contains("card")&&x!==i&&m++}var b,h=r.columns.find(function(t){return t.id===d}),L=r.columns.find(function(t){return t.id===l});if(h&&L)d===l?(b=t(h.cards.splice(c,1),1)[0],L.cards.splice(m,0,b)):(b=t(h.cards.splice(c,1),1)[0],L.cards.splice(m,0,b),i&&(i.dataset.columnId=l)),s&&s.parentNode&&s.replaceWith(i),a(),i&&i.classList.remove("dragging"),document.body.classList.remove("grabbing"),i=null,s=null,u=null,f=-1,p=!1;else console.error("Column not found in appState during drop operation.")}else console.warn("Drop occurred, but placeholder has no parent. Invalid drop target.")}}),document.addEventListener("DOMContentLoaded",l)})();